{"meta":{"title":"BLOG","subtitle":null,"description":2017,"author":"Leo","url":"http://yoursite.com"},"pages":[],"posts":[{"title":"微信公众平台JSSDK接口配置","slug":"微信公众平台JSSDK接口配置","date":"2017-02-28T03:03:03.000Z","updated":"2017-02-28T04:00:26.000Z","comments":true,"path":"2017/02/28/微信公众平台JSSDK接口配置/","link":"","permalink":"http://yoursite.com/2017/02/28/微信公众平台JSSDK接口配置/","excerpt":"","text":"步骤一：绑定域名 登录微信公众平台 公众号设置-&gt;功能设置-&gt;JS接口安全域名 步骤二：引入js文件 引入如下JS文件：http://res.wx.qq.com/open/js/jweixin-1.0.0.js 如果启用了https，则引入https://res.wx.qq.com/open/js/jweixin-1.0.0.js否则将无法在iOS9.0以上系统中成功使用JSSDK 如需使用摇一摇周边功能，请引入 jweixin-1.1.0.js 步骤三：通过config接口注入权限验证配置所有需要使用JS-SDK的页面必须先注入配置信息，否则将无法调用 12345678wx.config(&#123; debug: true, // 调试模式 appId: &apos;&apos;, // 必填，公众号的唯一标识 timestamp: , // 必填，生成签名的时间戳 nonceStr: &apos;&apos;, // 必填，生成签名的随机串（由开发者生成） signature: &apos;&apos;,// 必填，签名采用安全哈希算法生成 jsApiList: [] // 必填，需要使用的JS接口列表&#125;); 获取签名主要操作有：123获取access_token获取api_ticketsha1算法签名 第一步：根据微信提供的appid生成access_token公众号可以使用AppID和AppSecret调用本接口来获取access_token。AppID和AppSecret可在微信公众平台官网-开发者中心页中获得（需要已经成为开发者，且帐号没有异常状态）。注意调用所有微信接口时均需使用https协议。 接口调用请求说明123http请求方式: GET用自己的appid替换链接中的APPIDhttps://api.weixin.qq.com/cgi-bin/token?grant_type=client_credential&amp;appid=APPID&amp;secret=APPSECRET 正常情况下，微信会返回下述JSON数据包给公众号：1&#123;&quot;access_token&quot;:&quot;ACCESS_TOKEN&quot;,&quot;expires_in&quot;:7200&#125; 错误时微信会返回错误码等信息，JSON数据包示例如下（该示例为AppID无效错误）:1&#123;&quot;errcode&quot;:40013,&quot;errmsg&quot;:&quot;invalid appid&quot;&#125; 补充：如果没有开发者账号也通过以下链接沙盘测试账号申请测试号： http://mp.weixin.qq.com/debug/cgi-bin/sandbox?t=sandbox/login 第二步：根据access_token获取api_ticketapi_ticket 是用于调用微信卡券JS API的临时票据，有效期为7200 秒，通过access_token 来获取。 接口调用请求说明123http请求方式: GET第一步生成的access_token替换链接中的ACCESS_TOKENhttps://api.weixin.qq.com/cgi-bin/ticket/getticket?access_token=ACCESS_TOKEN&amp;type=jsapi 开发者注意事项：1.此用于卡券接口签名的api_ticket与步骤三中通过config接口注入权限验证配置使用的jsapi_ticket不同。 2.由于获取api_ticket 的api 调用次数非常有限，频繁刷新api_ticket 会导致api调用受限，影响自身业务，开发者需在自己的服务存储与更新api_ticket。 返回数据示例：123456&#123;&quot;errcode&quot;:0,&quot;errmsg&quot;:&quot;ok&quot;,&quot;ticket&quot;:&quot;bxLdikRXVbTPdHSM05e5u5sUoXNKd8-41ZO3MhKoyN5OfkWITDGgnr2fwJ0m9E8NYzWKVZvdVtaUgWvsdshFKA&quot;,&quot;expires_in&quot;:7200&#125; ticket即为jsapi_ticket 第三步：根据noncestr,jsapi_ticket,timestamp,url获取signature步骤1. 对所有待签名参数按照字段名的ASCII 码从小到大排序（字典序）后，使用URL键值对的格式（即key1=value1&amp;key2=value2…）拼接成字符串string1： 1jsapi_ticket=sM4AOVdWfPE4DxkXGEs8VMCPGGVi4C3VM0P37wVUCFvkVAy_90u5h9nbSlYy3-Sl-HhTdfl2fzFy1AOcHKP7qg&amp;noncestr=Wm3WZYTPz0wzccnW&amp;timestamp=1414587457&amp;url=http://mp.weixin.qq.com?params=value 步骤2. 对string1进行sha1签名，得到signature signature=sha1(string1)： 10f9de62fce790f9a083d5c99e95740ceb90c27ed 注意事项签名用的noncestr和timestamp必须与wx.config中的nonceStr和timestamp相同。签名用的url必须是调用JS接口页面的完整URL。出于安全考虑，开发者必须在服务器端实现签名的逻辑。 微信官方提供的示例代码（包含php，java，nodejs，python）： http://demo.open.weixin.qq.com/jssdk/sample.zip 整理自微信官方文档","categories":[],"tags":[]}]}